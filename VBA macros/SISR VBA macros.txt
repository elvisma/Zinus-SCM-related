
Sub Updating_Actual_Sales_All() 'need to run ALL first then others, and wmt.

Dim r, c, bycol, nofi As Integer    'r indicates row, c indicates column
Dim LastRow, LastColumn As Long
Dim loc As Worksheet
Dim cname, cname2 As String

    Set loc = ThisWorkbook.Sheets("SB")  'loc=location

With loc
  LastRow = .Cells(.Rows.Count, "F").End(xlUp).Row
  LastColumn = .Range("F1").CurrentRegion.Columns.Count
  
    Application.Calculation = xlCalculationManual   'speed up
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False

    r = 34      'From AMAZON
    c = 47      'Starting Column (Edit this every week)
    bycol = 48  'Ending Column (Edit this every week)
    nofi = 1    'Number of Item
    
    Do While (c < bycol + 1)                        '+1 to include bycol
        
        Do While (nofi < ((LastRow - 5) / 52) + 1)  'Subtract 5 to skip the first five rows which are a header of table. Then divide by rows(52) needed for a sub-table of one item.
            
            Do While (r < 52 * nofi - 17 + 1)
                
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4
            
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([SH.xlsx]all!$A$4:$DG$7000, MATCH(1,([SH.xlsx]all!$A$4:$A$7000=G" & r & ")*([SH.xlsx]all!$B$4:$B$7000=L" & r & "),0), MATCH(" & cname & ",([SH.xlsx]all!$A$1:$DG$1),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
            If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
             
            r = r + 1
              
            Loop
            r = r + 1 'To skip Amazon-DI
            
            Do While (r < 52 * nofi + 1)        'An=A1+(n-1)*D=51+(n-1)*52=52n-1, from Row 34 (Amazon) to Row 51 (zinus.com)
            
            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([SH.xlsx]all!$A$4:$DG$5000, MATCH(1,([SH.xlsx]all!$A$4:$A$5000='FM'!G" & r & ")*([SH.xlsx]all!$B$4:$B$5000='FM'!L" & r & "),0)," & c + 4 & "),"""")"
            'Check "c - x" at the end of above formula.
            
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4
            
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([SH.xlsx]all!$A$4:$DG$7000, MATCH(1,([SH.xlsx]all!$A$4:$A$7000=G" & r & ")*([SH.xlsx]all!$B$4:$B$7000=L" & r & "),0), MATCH(" & cname & ",([SH.xlsx]all!$A$1:$DG$1),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
            If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
    
            r = r + 1 'Row 34 to 51
            Loop

        r = r + 34      'Out at 52, to next Amazon row which is 86
        nofi = nofi + 1 'To next item
        Loop
    
    r = 34      'Back to FIRST channel(Amazon)
    nofi = 1    'Reset as default to repeat the loop
    c = c + 1   'Start from next column
    Loop
    
 End With
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 
End Sub

Sub Updating_Actual_Sales_Others()
'Since All macro includes others and WMT.com, we should run both after All macro.

Dim r, c, bycol, nofi As Integer 'r indicates row, c indicates column
Dim LastRow, LastColumn As Long
Dim loc As Worksheet
Dim cname, cname2 As String

    Set loc = ThisWorkbook.Sheets("SB")  'loc=location

With loc
  LastRow = .Cells(.Rows.Count, "F").End(xlUp).Row
  LastColumn = .Range("F1").CurrentRegion.Columns.Count
  
    Application.Calculation = xlCalculationManual   'speed up
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False

    r = 43      'From Others
    c = 24      'Starting Column (Edit this every week)
    bycol = 26  'Ending Column (Edit this every week)
    nofi = 1    'Number of Item
    
    Do While (c < bycol + 1)    '+1 to include bycol
        
        Do While (nofi < ((LastRow - 5) / 52) + 1)  'Subtract 5 to skip the first five rows which are a header of table. Then divide by rows(52) needed for a sub-table of one item.
     
            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([SH.xlsx]Others!$A$4:$DG$1000, MATCH(1,([SH.xlsx]Others!$A$4:$A$1000='FM'!G" & r & ")*([SH.xlsx]Others!$B$4:$B$1000='FM'!L" & r & "),0)," & c + 4 & "),"""")"
            'Check "c - x" at the end of above formula.
            
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4
            
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([SH.xlsx]Others!$A$4:$DG$1000, MATCH(1,([SH.xlsx]Others!$A$4:$A$1000='FR'!G" & r & ")*([SH.xlsx]Others!$B$4:$B$1000='FR'!L" & r & "),0), MATCH(" & cname & ",([SH.xlsx]Others!$A$1:$DG$1),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
            If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
        r = r + 52      'Out at 43, to next others row which is 95
        nofi = nofi + 1 'To next item
        Loop
    
    r = 43    'Back to the channel(Others)
    nofi = 1  'Reset as default to repeat the loop
    c = c + 1 'Start from next column
    Loop
    
 End With
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 
End Sub

Sub Updating_Actual_Sales_WMT()
'Since All macro includes others and WMT.com, we should run both after All macro.

Dim r, c, bycol, nofi As Integer 'r indicates row, c indicates column
Dim LastRow, LastColumn As Long
Dim loc As Worksheet
Dim cname, cname2 As String

    Set loc = ThisWorkbook.Sheets("SB")  'loc=location

With loc
  LastRow = .Cells(.Rows.Count, "F").End(xlUp).Row
  LastColumn = .Range("F1").CurrentRegion.Columns.Count
  
    Application.Calculation = xlCalculationManual   'speed up
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False

    r = 50      'From WMT
    c = 24      'Starting Column (Edit this every week)
    bycol = 26  'Ending Column (Edit this every week)
    nofi = 1    'Number of Item
    
    Do While (c < bycol + 1)    '+1 to include bycol
        
        Do While (nofi < ((LastRow - 5) / 52) + 1)  'Subtract 5 to skip the first five rows which are a header of table. Then divide by rows(52) needed for a sub-table of one item.
     
            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([SH.xlsx]wmt!$A$4:$DG$1000, MATCH(1,([SH.xlsx]wmt!$A$4:$A$1000='FM'!G" & r & ")*([SH.xlsx]wmt!$B$4:$B$1000='FM'!L" & r & "),0)," & c + 4 & "),"""")"
            'Check "c - x" at the end of above formula.
                        
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4
            
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([SH.xlsx]wmt!$A$4:$DG$1000, MATCH(1,([SH.xlsx]wmt!$A$4:$A$1000='FR'!G" & r & ")*([SH.xlsx]wmt!$B$4:$B$1000='FR'!L" & r & "),0), MATCH(" & cname & ",([SH.xlsx]wmt!$A$1:$DG$1),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
            If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
        r = r + 52      'Out at 43, to next others row which is 95
        nofi = nofi + 1 'To next item
        Loop
    
    r = 50    'Back to the channel(WMT)
    nofi = 1  'Reset as default to repeat the loop
    c = c + 1 'Start from next column
    Loop
    
 End With
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 
End Sub
Sub Updating_Actual_Sales_West_East()

Dim c, r, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim loc As Worksheet
Dim cname, cname2 As String

Set loc = ThisWorkbook.Sheets("SB")

With loc
  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count
  
    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False

    c = 47      'Starting Column
    bycol = 48  'Ending Column
    nofi = 1
    r = 16
    
    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
                      
        cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
        cname = cname2 & "" & 4 '4 indicates row 4
                    
        'West Actual
        .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([SH_West_East.xlsx]SHWE!$A$4:$DG$7000, MATCH(1,([SH_West_East.xlsx]SHWE!$A$4:$A$7000=G" & r & ")*([SH_West_East.xlsx]SHWE!$B$4:$B$7000=L" & r & "),0), MATCH(" & cname & ",([SH_West_East.xlsx]SHWE!$A$1:$DG$1),0)),0)"
        .Range(.Cells(r, c), .Cells(r, c)).Copy
        .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
        Application.CutCopyMode = False
            
        'If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
                
        'East Actual
        .Range(.Cells(r + 9, c), .Cells(r + 9, c)).FormulaArray = "=IFERROR(INDEX([SH_West_East.xlsx]SHWE!$A$4:$DG$7000, MATCH(1,([SH_West_East.xlsx]SHWE!$A$4:$A$7000=G" & r + 9 & ")*([SH_West_East.xlsx]SHWE!$B$4:$B$7000=L" & r + 9 & "),0), MATCH(" & cname & ",([SH_West_East.xlsx]SHWE!$A$1:$DG$1),0)),0)"
        .Range(.Cells(r + 9, c), .Cells(r + 9, c)).Copy
        .Range(.Cells(r + 9, c), .Cells(r + 9, c)).PasteSpecial (xlPasteValues)
        Application.CutCopyMode = False
            
        'If .Range(.Cells(r + 9, c), .Cells(r + 9, c)).Value = 0 Then .Range(.Cells(r + 9, c), .Cells(r + 9, c)).Value = ""
              
                
        r = r + 52
        nofi = nofi + 1
        Loop
    
    nofi = 1
    r = 16
    c = c + 1
    Loop
    
 End With
 
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 
 
End Sub

Sub read_F_AMAZON() 'Loading forecast numbers from account manager's sisr

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim d As String
Dim loc As Worksheet
Dim cname, cname2 As String

    Set loc = ThisWorkbook.Sheets("SB")      'loc=location
    
With loc
  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count

    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
  
    r = 34      'From Costco
    c = 73      'Starting Column
    bycol = 83  'Ending Column
    nofi = 1
    d = "08212018"

    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4
            
            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([COSTCOCOM_" & sdate & ".xlsm]Demand!$A$4:$BW$1000, MATCH(1,([COSTCOCOM_" & sdate & ".xlsm]Demand!$D$4:$D$1000=G" & r & ")*([COSTCOCOM_" & sdate & ".xlsm]Demand!$F$4:$F$1000=L" & r & "),0)," & c + 97 & "),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([AMAZON_" & d & ".xlsm]Demand!$A$4:$CZ$6000, MATCH(1,([AMAZON_" & d & ".xlsm]Demand!$B$4:$B$6000=G" & r & ")*([AMAZON_" & d & ".xlsm]Demand!$G$4:$G$6000=L" & r & "),0),MATCH(" & cname & ",([AMAZON_" & d & ".xlsm]Demand!$A$2:$CZ$2),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
             If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
    
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 34
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 End With
 
 
End Sub

Sub read_F_COSTCO() 'Loading forecast numbers from account manager's sisr

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim d As String
Dim loc As Worksheet
Dim cname, cname2 As String

    Set loc = ThisWorkbook.Sheets("SB")      'loc=location
    
With loc
  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count

    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
  
    r = 39      'From Costco
    c = 68      'Starting Column
    bycol = 90  'Ending Column
    nofi = 1
    d = "01222019"

    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4
            
            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([COSTCOCOM_" & sdate & ".xlsm]Demand!$A$4:$BW$1000, MATCH(1,([COSTCOCOM_" & sdate & ".xlsm]Demand!$D$4:$D$1000=G" & r & ")*([COSTCOCOM_" & sdate & ".xlsm]Demand!$F$4:$F$1000=L" & r & "),0)," & c + 97 & "),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([COSTCOCOM_" & d & ".xlsm]Demand!$A$4:$CE$1000, MATCH(1,([COSTCOCOM_" & d & ".xlsm]Demand!$B$4:$B$1000=G" & r & ")*([COSTCOCOM_" & d & ".xlsm]Demand!$D$4:$D$1000=L" & r & "),0),MATCH(" & cname & ",([COSTCOCOM_" & d & ".xlsm]Demand!$A$2:$CE$2),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
             If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
    
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 39
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 
 End With
 
 
End Sub

Sub read_F_HomeDepot() 'Loading forecast numbers from account manager's sisr

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim d As String
Dim loc As Worksheet
Dim cname, cname2 As String

    Set loc = ThisWorkbook.Sheets("SB")      'loc=location
    
With loc
  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count

    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
  
    r = 40      'From HomeDepot
    c = 68      'Starting Column
    bycol = 90  'Ending Column
    nofi = 1
    d = "01222019"

    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4

            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([HOMEDEPOT_" & sdate & ".xlsm]Demand!$A$4:$EF$1000, MATCH(1,([HOMEDEPOT_" & sdate & ".xlsm]Demand!$D$4:$D$1000=G" & r & ")*([HOMEDEPOT_" & sdate & ".xlsm]Demand!$F$4:$F$1000=L" & r & "),0)," & c + 97 & "),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([HomeDepot_" & d & ".xlsm]Demand!$A$4:$CF$6000, MATCH(1,([HomeDepot_" & d & ".xlsm]Demand!$D$4:$D$6000=G" & r & ")*([HomeDepot_" & d & ".xlsm]Demand!$G$4:$G$6000=L" & r & "),0) ,MATCH(" & cname & ",([HomeDepot_" & d & ".xlsm]Demand!$A$2:$CF$2),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
             If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
    
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 40
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 End With
 
 
End Sub

Sub read_F_Jet() 'Loading forecast numbers from account manager's sisr

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim sdate As String
Dim loc As Worksheet

    Set loc = ThisWorkbook.Sheets("SB")      'loc=location
    
With loc
  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count

    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
  
    r = 41      'From Jet
    c = 14      'Starting Column
    bycol = 15  'Ending Column
    nofi = 1
    d = "12272016"

    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4

            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([JET_" & sdate & ".xlsm]Demand!$A$4:$EF$1000, MATCH(1,([JET_" & sdate & ".xlsm]Demand!$D$4:$D$1000=G" & r & ")*([JET_" & sdate & ".xlsm]Demand!$F$4:$F$1000=L" & r & "),0)," & c + 97 & "),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([JET_" & d & ".xlsm]Demand!$A$4:$EF$1000, MATCH(1,([JET_" & d & ".xlsm]Demand!$D$4:$D$1000=G" & r & ")*([JET_" & d & ".xlsm]Demand!$F$4:$F$1000=L" & r & "),0) ,MATCH(" & cname & ",([JET_" & d & ".xlsm]Demand!$A$2:$EF$2),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
             If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
    
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 41
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 End With
 
 
End Sub

Sub read_F_Kmart() 'Loading forecast numbers from account manager's sisr

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim sdate As String
Dim loc As Worksheet

    Set loc = ThisWorkbook.Sheets("SB")      'loc=location
    
With loc
  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count

    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
  
    r = 42      'From Kmart
    c = 14      'Starting Column
    bycol = 15  'Ending Column
    nofi = 1
    d = "01032017"

    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4

            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([Sears_Kmart_" & sdate & ".xlsm]Demand!$A$4:$EF$2500, MATCH(1,([Sears_Kmart_" & sdate & ".xlsm]Demand!$D$4:$D$2500=G" & r & ")*([Sears_Kmart_" & sdate & ".xlsm]Demand!$F$4:$F$2500=L" & r & "),0)," & c + 97 & "),"""")"
            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([Sears_Kmart_" & d & ".xlsm]Demand!$A$4:$EF$2500, MATCH(1,([Sears_Kmart_" & d & ".xlsm]Demand!$D$4:$D$2500=G" & r & ")*([Sears_Kmart_" & d & ".xlsm]Demand!$F$4:$F$2500=L" & r & "),0) ,MATCH(" & cname & ",([Sears_Kmart_" & d & ".xlsm]Demand!$A$2:$EF$2),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([SK_" & d & ".xlsm]Demand!$A$4:$EF$2500, MATCH(1,([SK_" & d & ".xlsm]Demand!$D$4:$D$2500=G" & r & ")*([SK_" & d & ".xlsm]Demand!$F$4:$F$2500=L" & r & "),0) ,MATCH(" & cname & ",([SK_" & d & ".xlsm]Demand!$A$2:$EF$2),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
             If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
    
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 42
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 End With
 
 
End Sub

Sub read_F_Others() 'Loading forecast numbers from account manager's sisr

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim sdate As String
Dim loc As Worksheet

    Set loc = ThisWorkbook.Sheets("SB")      'loc=location
    
With loc
  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count

    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
  
    r = 43      'From Others
    c = 14      'Starting Column
    bycol = 15  'Ending Column
    nofi = 1
    d = "01032017"

    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4
            
            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([Others_" & sdate & ".xlsm]Demand!$A$4:$EF$1500, MATCH(1,([Others_" & sdate & ".xlsm]Demand!$D$4:$D$1500=G" & r & ")*([Others_" & sdate & ".xlsm]Demand!$F$4:$F$1500=L" & r & "),0)," & c + 97 & "),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([Others_" & d & ".xlsm]Demand!$A$4:$EF$1500, MATCH(1,([Others_" & d & ".xlsm]Demand!$D$4:$D$1500=G" & r & ")*([Others_" & d & ".xlsm]Demand!$F$4:$F$1500=L" & r & "),0) ,MATCH(" & cname & ",([Others_" & d & ".xlsm]Demand!$A$2:$EF$2),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
             If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
    
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 43
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 End With
 
 
End Sub

Sub read_F_Overstock() 'Loading forecast numbers from account manager's sisr

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim d As String
Dim loc As Worksheet
Dim cname, cname2 As String

    Set loc = ThisWorkbook.Sheets("SB")      'loc=location
    
With loc
  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count

    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
  
    r = 44      'From Overstock
    c = 68     'Starting Column
    bycol = 90  'Ending Column
    nofi = 1
    d = "01222019"

    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4

            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([OVERSTOCK_" & sdate & ".xlsm]Demand!$A$4:$EF$1000, MATCH(1,([OVERSTOCK_" & sdate & ".xlsm]Demand!$D$4:$D$1000=G" & r & ")*([OVERSTOCK_" & sdate & ".xlsm]Demand!$F$4:$F$1000=L" & r & "),0)," & c + 97 & "),"""")"
            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([OVERSTOCK_" & d & ".xlsm]Demand!$A$4:$EF$1000, MATCH(1,([OVERSTOCK_" & d & ".xlsm]Demand!$D$4:$D$1000=G" & r & ")*([OVERSTOCK_" & d & ".xlsm]Demand!$F$4:$F$1000=L" & r & "),0) ,MATCH(" & cname & ",([OVERSTOCK_" & d & ".xlsm]Demand!$A$2:$EF$2),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([O_" & d & ".xlsm]Demand!$A$4:$IG$5000, MATCH(1,([O_" & d & ".xlsm]Demand!$D$4:$D$5000=G" & r & ")*([O_" & d & ".xlsm]Demand!$G$4:$G$5000=L" & r & "),0) ,MATCH(" & cname & ",([O_" & d & ".xlsm]Demand!$A$2:$IG$2),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
             If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
    
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 44
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 End With
 
 
End Sub

Sub read_F_SAMSCLUB() 'Loading forecast numbers from account manager's sisr

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim d As String
Dim loc As Worksheet
Dim cname, cname2 As String

    Set loc = ThisWorkbook.Sheets("SB")      'loc=location
    
With loc
  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count

    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
  
    r = 45      'From Samsclub
    c = 76      'Starting Column
    bycol = 96  'Ending Column
    nofi = 1
    d = "testing"

    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4

            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([SAMSCLUB_" & sdate & ".xlsm]Demand!$A$4:$EE$1000, MATCH(1,([SAMSCLUB_" & sdate & ".xlsm]Demand!$D$4:$D$1000=G" & r & ")*([SAMSCLUB_" & sdate & ".xlsm]Demand!$E$4:$E$1000=L" & r & "),0)," & c + 96 & "),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([SAMSCLUB_" & d & ".xlsb]Demand!$A$4:$CR$6000, MATCH(1,([SAMSCLUB_" & d & ".xlsb]Demand!$B$4:$B$6000=G" & r & ")*([SAMSCLUB_" & d & ".xlsb]Demand!$D$4:$D$6000=L" & r & "),0) ,MATCH(" & cname & ",([SAMSCLUB_" & d & ".xlsb]Demand!$A$2:$CR$2),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
             If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
    
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 45
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 End With
 
 
End Sub

Sub read_F_Sears() 'Loading forecast numbers from account manager's sisr

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim sdate As String
Dim loc As Worksheet

    Set loc = ThisWorkbook.Sheets("SB")      'loc=location
    
With loc
  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count

    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
  
    r = 46      'From Sears
    c = 14      'Starting Column
    bycol = 39  'Ending Column
    nofi = 1
    d = "01032017"

    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4

            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([Sears_Kmart_" & sdate & ".xlsm]Demand!$A$4:$EF$2500, MATCH(1,([Sears_Kmart_" & sdate & ".xlsm]Demand!$D$4:$D$2500=G" & r & ")*([Sears_Kmart_" & sdate & ".xlsm]Demand!$F$4:$F$2500=L" & r & "),0)," & c + 97 & "),"""")"
            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([Sears_Kmart_" & d & ".xlsm]Demand!$A$4:$EF$2500, MATCH(1,([Sears_Kmart_" & d & ".xlsm]Demand!$D$4:$D$2500=G" & r & ")*([Sears_Kmart_" & d & ".xlsm]Demand!$F$4:$F$2500=L" & r & "),0) ,MATCH(" & cname & ",([Sears_Kmart_" & d & ".xlsm]Demand!$A$2:$EF$2),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([SK_" & d & ".xlsm]Demand!$A$4:$EF$2500, MATCH(1,([SK_" & d & ".xlsm]Demand!$D$4:$D$2500=G" & r & ")*([SK_" & d & ".xlsm]Demand!$F$4:$F$2500=L" & r & "),0) ,MATCH(" & cname & ",([SK_" & d & ".xlsm]Demand!$A$2:$EF$2),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
             If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
    
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 46
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 End With
 
 
End Sub

Sub read_F_Sears_DS() 'Loading forecast numbers from account manager's sisr

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim sdate As String
Dim loc As Worksheet

    Set loc = ThisWorkbook.Sheets("SB")      'loc=location
    
With loc
  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count

    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
  
    r = 47      'From Sears-DS
    c = 14      'Starting Column
    bycol = 39  'Ending Column
    nofi = 1
    d = "01032017"

    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4

            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([Sears_Kmart_" & sdate & ".xlsm]Demand!$A$4:$EF$2500, MATCH(1,([Sears_Kmart_" & sdate & ".xlsm]Demand!$D$4:$D$2500=G" & r & ")*([Sears_Kmart_" & sdate & ".xlsm]Demand!$F$4:$F$2500=L" & r & "),0)," & c + 97 & "),"""")"
            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([Sears_Kmart_" & d & ".xlsm]Demand!$A$4:$EF$2500, MATCH(1,([Sears_Kmart_" & d & ".xlsm]Demand!$D$4:$D$2500=G" & r & ")*([Sears_Kmart_" & d & ".xlsm]Demand!$F$4:$F$2500=L" & r & "),0) ,MATCH(" & cname & ",([Sears_Kmart_" & d & ".xlsm]Demand!$A$2:$EF$2),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([SK_" & d & ".xlsm]Demand!$A$4:$EF$2500, MATCH(1,([SK_" & d & ".xlsm]Demand!$D$4:$D$2500=G" & r & ")*([SK_" & d & ".xlsm]Demand!$F$4:$F$2500=L" & r & "),0) ,MATCH(" & cname & ",([SK_" & d & ".xlsm]Demand!$A$2:$EF$2),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
             If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
    
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 47
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 End With
 
 
End Sub

Sub read_F_Target() 'Loading forecast numbers from account manager's sisr

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim d As String
Dim loc As Worksheet
Dim cname, cname2 As String

    Set loc = ThisWorkbook.Sheets("SB")      'loc=location
    
With loc
  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count

    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
  
    r = 48      'From Target
    c = 68     'Starting Column
    bycol = 90  'Ending Column
    nofi = 1
    d = "01222019"

    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4

            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([TARGET_" & sdate & ".xlsm]Demand!$A$4:$DX$500, MATCH(1,([TARGET_" & sdate & ".xlsm]Demand!$D$4:$D$500=G" & r & ")*([TARGET_" & sdate & ".xlsm]Demand!$F$4:$F$500=L" & r & "),0)," & c + 97 & "),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([TARGET_" & d & ".xlsm]Demand!$A$4:$IG$6000, MATCH(1,([TARGET_" & d & ".xlsm]Demand!$D$4:$D$6000=G" & r & ")*([TARGET_" & d & ".xlsm]Demand!$G$4:$G$1000=L" & r & "),0) ,MATCH(" & cname & ",([TARGET_" & d & ".xlsm]Demand!$A$2:$IG$2),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
             If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
    
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 48
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 End With
 
 
End Sub

Sub read_F_Wayfair() 'Loading forecast numbers from account manager's sisr

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim d As String
Dim loc As Worksheet
Dim cname, cname2 As String

    Set loc = ThisWorkbook.Sheets("SB")      'loc=location
    
With loc
  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count

    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
  
    r = 49      'From Wayfair
    c = 32    'Starting Column
    bycol = 57  'Ending Column
    nofi = 1
    d = "testing"

    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4

            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([TARGET_" & sdate & ".xlsm]Demand!$A$4:$DX$700, MATCH(1,([TARGET_" & sdate & ".xlsm]Demand!$D$4:$D$700=G" & r & ")*([TARGET_" & sdate & ".xlsm]Demand!$F$4:$F$700=L" & r & "),0)," & c + 97 & "),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([USWayfair_" & d & ".xlsm]Master!$A$4:$EF$6000, MATCH(1,([USWayfair_" & d & ".xlsm]Master!$D$4:$D$6000=G" & r & ")*([USWayfair_" & d & ".xlsm]Master!$F$4:$F$6000=""ZINUS DDS""),0) ,MATCH(" & cname & ",([USWayfair_" & d & ".xlsm]Master!$A$3:$EF$3),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
             If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
    
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 49
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 End With
 
 
End Sub

Sub read_F_WMT() 'Loading forecast numbers from account manager's sisr

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim d As String
Dim loc As Worksheet
Dim cname, cname2 As String

    Set loc = ThisWorkbook.Sheets("SB")      'loc=location
    
With loc
  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count

    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
  
    r = 50      'From WMT
    c = 78     'Starting Column
    bycol = 103  'Ending Column
    nofi = 1
    d = "testing"

    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4

            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([WMT_" & sdate & ".xlsm]Demand!$A$4:$FM$1000, MATCH(1,([WMT_" & sdate & ".xlsm]Demand!$D$4:$D$1000=G" & r & ")*([WMT_" & sdate & ".xlsm]Demand!$F$4:$F$1000=L" & r & "),0)," & c + 97 & "),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([WMT_" & d & ".xlsm]Demand!$A$4:$GH$6000, MATCH(1,([WMT_" & d & ".xlsm]Demand!$D$4:$D6000=G" & r & ")*([WMT_" & d & ".xlsm]Demand!$G$4:$G$6000=L" & r & "),0) ,MATCH(" & cname & ",([WMT_" & d & ".xlsm]Demand!$A$3:$GH$3),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
             If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
    
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 50
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 End With
 
 
End Sub

Sub read_F_ZINUS() 'Loading forecast numbers from account manager's sisr

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim d As String
Dim loc As Worksheet
Dim cname, cname2 As String

    Set loc = ThisWorkbook.Sheets("SB")      'loc=location
    
With loc
  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count

    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
  
    r = 51      'From ZINUS
    c = 68     'Starting Column
    bycol = 90 'Ending Column
    nofi = 1
    d = "01222019"

    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4

            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([ZINUSCOM_" & sdate & ".xlsm]Demand!$A$4:$DS$1000, MATCH(1,([ZINUSCOM_" & sdate & ".xlsm]Demand!$D$4:$D$1000=G" & r & ")*([ZINUSCOM_" & sdate & ".xlsm]Demand!$F$4:$F$1000=L" & r & "),0)," & c + 97 & "),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([ZINUSCOM_" & d & ".xlsm]Demand!$A$4:$BC$6000, MATCH(1,([ZINUSCOM_" & d & ".xlsm]Demand!$D$4:$D$6000=G" & r & ")*([ZINUSCOM_" & d & ".xlsm]Demand!$F$4:$F$6000=L" & r & "),0) ,MATCH(" & cname & ",([ZINUSCOM_" & d & ".xlsm]Demand!$A$2:$BC$2),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
             If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
    
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 51
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 End With
 
 
End Sub

Sub read_F_SET_ITEM()

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim sdate As String
Dim loc As Worksheet

    Set loc = ThisWorkbook.Sheets("SB")      'loc=location
    
With loc
  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count

    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
  
    r = 38      'From AMAZON-SET-ITEM
    c = 14      'Starting Column
    bycol = 39  'Ending Column
    nofi = 1
    sdate = "01032017"
    cw = 2      'Current week Column on SET.xlsx

    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
    

            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(VLOOKUP(G" & r & ",[SET_" & sdate & ".xlsm]SET!$A$2:$AA$200," & cw & ", FALSE),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
             If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
    
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 38
    nofi = 1
    c = c + 1
    cw = cw + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 End With
 
 
End Sub

Sub Updating_PO_Number_West()

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim loc As Worksheet
Dim cname, cname2 As String

    Set loc = ThisWorkbook.Sheets("SB")
        
With loc
  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count

    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
    
    r = 18      'PO# of West
    c = 46    'Starting Column
    bycol = 69  'Ending Column
    nofi = 1

    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4
           
           'PO# of West
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([PO_WEST.xlsx]PO_Number_WEST!$A$2:$C$9000, MATCH(1,([PO_WEST.xlsx]PO_Number_WEST!$A$2:$A$9000='SB'!" & cname & ")*([PO_WEST.xlsx]PO_Number_WEST!$B$2:$B$9000='SB'!G" & r & "),0),3),"""")"
            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([PO_WEST.xlsx]PO_WEST!$A$2:$C$7000, MATCH(1,([PO_WEST.xlsx]PO_WEST!$A$2:$A$7000='FR'!" & cname & ")*([PO_WEST.xlsx]PO_WEST!$B$2:$B$7000='FR'!G" & r & "),0),3),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
             If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
        
        r = r + 52
        nofi = nofi + 1
        Loop
    
    r = 18
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
    
 End With

 
End Sub

Sub Updating_PO_Number_East()

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim loc As Worksheet
Dim cname, cname2 As String

    Set loc = ThisWorkbook.Sheets("SB")
        
With loc
  LastRow = .Cells(.Rows.Count, "F").End(xlUp).Row
  LastColumn = .Range("F1").CurrentRegion.Columns.Count

    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
    
    r = 27      'PO# of East
    c = 46      'Starting Column
    bycol = 69  'Ending Column
    nofi = 1
    
      Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4
    
            'PO# of East
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([PO_EAST.xlsx]PO_Number_EAST!$A$2:$C$8000, MATCH(1,([PO_EAST.xlsx]PO_Number_EAST!$A$2:$A$8000='SB'!" & cname & ")*([PO_EAST.xlsx]PO_Number_EAST!$B$2:$B$8000='SB'!G" & r & "),0),3),"""")"
            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([PO_EAST.xlsx]PO_EAST!$A$2:$C$7000, MATCH(1,([PO_EAST.xlsx]PO_EAST!$A$2:$A$7000='FR'!" & cname & ")*([PO_EAST.xlsx]PO_EAST!$B$2:$B$7000='FR'!G" & r & "),0),3),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
             If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
        r = r + 52
        nofi = nofi + 1
        Loop
    
    r = 27
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
    
 End With

 
End Sub

Sub Updating_PO_QTY_West()

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim loc As Worksheet
Dim cname, cname2 As String

    Set loc = ThisWorkbook.Sheets("SB")
        
With loc
  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count

    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
    
    r = 19      'PO QTY of West
    c = 46      'Starting Column
    bycol = 69 'Ending Column
    nofi = 1
    
      Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4
            
            'WEST
            'NEW INV = PO received
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([PO_WEST.xlsx]PO_QTY_WEST!$A$2:$E$8000, MATCH(1,([PO_WEST.xlsx]PO_QTY_WEST!$A$2:$A$8000='SB'!" & cname & ")*([PO_WEST.xlsx]PO_QTY_WEST!$B$2:$B$8000='SB'!G" & r & "),0),4),"""")"
            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([PO_WEST.xlsx]PO_WEST!$A$2:$F$7000, MATCH(1,([PO_WEST.xlsx]PO_WEST!$A$2:$A$7000='FR'!" & cname & ")*([PO_WEST.xlsx]PO_WEST!$B$2:$B$7000='FR'!G" & r & "),0),5),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
           If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
    
            'in transit = PO outstanding
            .Range(.Cells(r + 1, c), .Cells(r + 1, c)).FormulaArray = "=IFERROR(INDEX([PO_WEST.xlsx]PO_QTY_WEST!$A$2:$E$8000, MATCH(1,([PO_WEST.xlsx]PO_QTY_WEST!$A$2:$A$8000='SB'!" & cname & ")*([PO_WEST.xlsx]PO_QTY_WEST!$B$2:$B$8000='SB'!G" & r & "),0),3),"""")"
            '.Range(.Cells(r + 1, c), .Cells(r + 1, c)).FormulaArray = "=IFERROR(INDEX([PO_WEST.xlsx]PO_WEST!$A$2:$F$7000, MATCH(1,([PO_WEST.xlsx]PO_WEST!$A$2:$A$7000='FR'!" & cname & ")*([PO_WEST.xlsx]PO_WEST!$B$2:$B$7000='FR'!G" & r & "),0),6),"""")"
            .Range(.Cells(r + 1, c), .Cells(r + 1, c)).Copy
            .Range(.Cells(r + 1, c), .Cells(r + 1, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
           If .Range(.Cells(r + 1, c), .Cells(r + 1, c)).Value = 0 Then .Range(.Cells(r + 1, c), .Cells(r + 1, c)).Value = ""
            
        r = r + 52
        nofi = nofi + 1
        Loop
    
    r = 19
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
    
 End With

 
End Sub

Sub Updating_PO_QTY_East()

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim loc As Worksheet
Dim cname, cname2 As String

    Set loc = ThisWorkbook.Sheets("SB")
        
With loc
  LastRow = .Cells(.Rows.Count, "F").End(xlUp).Row
  LastColumn = .Range("F1").CurrentRegion.Columns.Count

    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
    
    r = 28     'PO QTY of East
    c = 46     'Starting Column
    bycol = 69 'Ending Column
    nofi = 1
    
      Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4
    
            'EAST
            'NEW INV = PO received
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([PO_EAST.xlsx]PO_QTY_EAST!$A$2:$E$8000, MATCH(1,([PO_EAST.xlsx]PO_QTY_EAST!$A$2:$A$8000='SB'!" & cname & ")*([PO_EAST.xlsx]PO_QTY_EAST!$B$2:$B$8000='SB'!G" & r & "),0),4),"""")"
            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([PO_EAST.xlsx]PO_EAST!$A$2:$F$7000, MATCH(1,([PO_EAST.xlsx]PO_EAST!$A$2:$A$7000='FR'!" & cname & ")*([PO_EAST.xlsx]PO_EAST!$B$2:$B$7000='FR'!G" & r & "),0),5),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
           If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
    
            'in transit = PO outstanding
            .Range(.Cells(r + 1, c), .Cells(r + 1, c)).FormulaArray = "=IFERROR(INDEX([PO_EAST.xlsx]PO_QTY_EAST!$A$2:$E$8000, MATCH(1,([PO_EAST.xlsx]PO_QTY_EAST!$A$2:$A$8000='SB'!" & cname & ")*([PO_EAST.xlsx]PO_QTY_EAST!$B$2:$B$8000='SB'!G" & r & "),0),3),"""")"
            '.Range(.Cells(r + 1, c), .Cells(r + 1, c)).FormulaArray = "=IFERROR(INDEX([PO_EAST.xlsx]PO_EAST!$A$2:$F$7000, MATCH(1,([PO_EAST.xlsx]PO_EAST!$A$2:$A$7000='FR'!" & cname & ")*([PO_EAST.xlsx]PO_EAST!$B$2:$B$7000='FR'!G" & r & "),0),6),"""")"
            .Range(.Cells(r + 1, c), .Cells(r + 1, c)).Copy
            .Range(.Cells(r + 1, c), .Cells(r + 1, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
           If .Range(.Cells(r + 1, c), .Cells(r + 1, c)).Value = 0 Then .Range(.Cells(r + 1, c), .Cells(r + 1, c)).Value = ""
        

        r = r + 52
        nofi = nofi + 1
        Loop
    
    r = 28
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
    
 End With

 
End Sub
Sub Before_Sending_To_China_Forecast()

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim loc As Worksheet

    Set loc = ThisWorkbook.Sheets("SB")

With loc
  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count
 
    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
    
    r = 8       'Total Forecast Qty#
    c = 49      'Starting Column
    bycol = 49  'Ending Column
    nofi = 1

    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            'Total Forecast Qty#
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
            'If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            'West DF#
            .Range(.Cells(r + 9, c), .Cells(r + 9, c)).Copy
            .Range(.Cells(r + 9, c), .Cells(r + 9, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
            'If .Range(.Cells(r + 9, c), .Cells(r + 9, c)).Value = 0 Then .Range(.Cells(r + 9, c), .Cells(r + 9, c)).Value = ""
                
             'East DF#
            .Range(.Cells(r + 18, c), .Cells(r + 18, c)).Copy
            .Range(.Cells(r + 18, c), .Cells(r + 18, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
            'If .Range(.Cells(r + 18, c), .Cells(r + 18, c)).Value = 0 Then .Range(.Cells(r + 18, c), .Cells(r + 18, c)).Value = ""
                                     
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 8
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
    
 End With
 
 
End Sub

Sub Before_Sending_To_China_inTransit()

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim loc As Worksheet

    Set loc = ThisWorkbook.Sheets("SB")

With loc
  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count
 
    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
    
    r = 20      'inTransit# of West
    c = 61      'Starting Column
    bycol = 61  'Ending Column
    nofi = 1

    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            'WEST
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
            If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            'EAST
            .Range(.Cells(r + 9, c + 2), .Cells(r + 9, c + 2)).Copy
            .Range(.Cells(r + 9, c + 2), .Cells(r + 9, c + 2)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
            If .Range(.Cells(r + 9, c + 2), .Cells(r + 9, c + 2)).Value = 0 Then .Range(.Cells(r + 9, c + 2), .Cells(r + 9, c + 2)).Value = ""
        
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 20
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
    
 End With
 
 
End Sub
Sub read_Finalized_Amazon_DO_DDS_DI_From_AISR()

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim d As String
Dim loc As Worksheet
Dim cname, cname2 As String

    Set loc = ThisWorkbook.Sheets("SB")      'loc=location
    
With loc
  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count

    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
  
    r = 37      'From AMAZON-DO
    c = 49      'Starting Column
    bycol = 65  'Ending Column
    nofi = 1
    d = "20190818"
    
    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4
            
            'AMAZON-DO
            'INDEX([SISR_Foam_Mattress_12282016_testingmacro.xlsm]Foam!$A$6:$AV$57, MATCH(1,([SISR_Foam_Mattress_12282016_testingmacro.xlsm]Foam!$G$6:$G$57=G32)*([SISR_Foam_Mattress_12282016_testingmacro.xlsm]Foam!$L$6:$L$57="Total E.I. excluding Amazon"),0),MATCH(R4,([SISR_Foam_Mattress_12282016_testingmacro.xlsm]Foam!$A$4:$AV$4)))
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([AISR_SB_" & d & ".xlsm]SB!$A$6:$CV$15000, MATCH(1,([AISR_SB_" & d & ".xlsm]SB!$G$6:$G$15000=G" & r & ")*([AISR_SB_" & d & ".xlsm]SB!$J$6:$J$15000=L" & r & "),0),MATCH(" & cname & ",([AISR_SB_" & d & ".xlsm]SB!$A$4:$CV$4),0)),"""")"
            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=INDEX([AISR_FM_" & d & ".xlsm]Foam!$A$6:$AZ$8000, MATCH(1,([AISR_FM_" & d & ".xlsm]Foam!$G$6:$G$8000=G" & r & ")*([AISR_FM_" & d & ".xlsm]Foam!$J$6:$J$8000=L" & r & "),0)," & c + 4 & ")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
            If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
            'AMAZON-DDS
            .Range(.Cells(r - 2, c), .Cells(r - 2, c)).FormulaArray = "=IFERROR(INDEX([AISR_SB_" & d & ".xlsm]SB!$A$6:$CV$15000, MATCH(1,([AISR_SB_" & d & ".xlsm]SB!$G$6:$G$15000=G" & r - 2 & ")*([AISR_SB_" & d & ".xlsm]SB!$J$6:$J$15000=L" & r - 2 & "),0),MATCH(" & cname & ",([AISR_SB_" & d & ".xlsm]SB!$A$4:$CV$4),0)),"""")"
            .Range(.Cells(r - 2, c), .Cells(r - 2, c)).Copy
            .Range(.Cells(r - 2, c), .Cells(r - 2, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
            If .Range(.Cells(r - 2, c), .Cells(r - 2, c)).Value = 0 Then .Range(.Cells(r - 2, c), .Cells(r - 2, c)).Value = ""
            
            'AMAZON-DI
            '.Range(.Cells(r - 1, c), .Cells(r - 1, c)).FormulaArray = "=IFERROR(INDEX([AISR_FR_" & d & ".xlsm]FR!$A$6:$AZ$8000, MATCH(1,([AISR_FR_" & d & ".xlsm]FR!$G$6:$G$8000=G" & r - 1 & ")*([AISR_FR_" & d & ".xlsm]FR!$J$6:$J$8000=L" & r - 1 & "),0),MATCH(" & cname & ",([AISR_FR_" & d & ".xlsm]FR!$A$4:$AZ$4),0)),"""")"
            '.Range(.Cells(r - 1, c), .Cells(r - 1, c)).Copy
            '.Range(.Cells(r - 1, c), .Cells(r - 1, c)).PasteSpecial (xlPasteValues)
            'Application.CutCopyMode = False
            
            'If .Range(.Cells(r - 1, c), .Cells(r - 1, c)).Value = 0 Then .Range(.Cells(r - 1, c), .Cells(r - 1, c)).Value = ""
            
            
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 37
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 End With
 
 
End Sub
Sub read_Confirmed_DO_From_AISR() 'in case, we need to update DO only.

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim d As String
Dim loc As Worksheet

    Set loc = ThisWorkbook.Sheets("SB")      'loc=location
    
With loc
  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count

    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
  
    r = 37      'From AMAZON-DO
    c = 22      'Starting Column
    bycol = 22  'Ending Column
    nofi = 1
    d = "02262017"
    
    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4
            
            'AMAZON-DO
            'INDEX([SISR_Foam_Mattress_12282016_testingmacro.xlsm]Foam!$A$6:$AV$57, MATCH(1,([SISR_Foam_Mattress_12282016_testingmacro.xlsm]Foam!$G$6:$G$57=G32)*([SISR_Foam_Mattress_12282016_testingmacro.xlsm]Foam!$L$6:$L$57="Total E.I. excluding Amazon"),0),MATCH(R4,([SISR_Foam_Mattress_12282016_testingmacro.xlsm]Foam!$A$4:$AV$4)))
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([AISR_FR_" & d & ".xlsm]FR!$A$6:$AZ$8000, MATCH(1,([AISR_FR_" & d & ".xlsm]FR!$G$6:$G$8000=G" & r & ")*([AISR_FR_" & d & ".xlsm]FR!$J$6:$J$8000=""CFDO""),0),MATCH(" & cname & ",([AISR_FR_" & d & ".xlsm]FR!$A$4:$AZ$4),0)),"""")"
            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=INDEX([AISR_FM_" & d & ".xlsm]Foam!$A$6:$AZ$8000, MATCH(1,([AISR_FM_" & d & ".xlsm]Foam!$G$6:$G$8000=G" & r & ")*([AISR_FM_" & d & ".xlsm]Foam!$J$6:$J$8000=L" & r & "),0)," & c + 4 & ")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
            If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
            
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 37
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 End With
 
 
End Sub
Sub read_Finalized_Amazon_DI_From_AISR() 'in case, we need to update DI

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim d As String
Dim loc As Worksheet
Dim cname, cname2 As String

    Set loc = ThisWorkbook.Sheets("SB")      'loc=location
    
With loc
  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count

    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
  
    r = 36      'From AMAZON-DI
    c = 72     'Starting Column
    bycol = 91  'Ending Column
    nofi = 1
    d = "12092018"
    
    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 2 '2 indicates row 2
            
            'AMAZON-DI
            'INDEX([SISR_Foam_Mattress_12282016_testingmacro.xlsm]Foam!$A$6:$AV$57, MATCH(1,([SISR_Foam_Mattress_12282016_testingmacro.xlsm]Foam!$G$6:$G$57=G32)*([SISR_Foam_Mattress_12282016_testingmacro.xlsm]Foam!$L$6:$L$57="Total E.I. excluding Amazon"),0),MATCH(R4,([SISR_Foam_Mattress_12282016_testingmacro.xlsm]Foam!$A$4:$AV$4)))
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([AISR_FR_" & d & ".xlsm]FR!$A$6:$CV$15000, MATCH(1,([AISR_FR_" & d & ".xlsm]FR!$G$6:$G$15000=G" & r & ")*([AISR_FR_" & d & ".xlsm]FR!$J$6:$J$15000=L" & r & "),0),MATCH(" & cname & ",([AISR_FR_" & d & ".xlsm]FR!$A$2:$CV$2),0)),"""")"
            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=INDEX([AISR_FM_" & d & ".xlsm]Foam!$A$6:$AZ$8000, MATCH(1,([AISR_FM_" & d & ".xlsm]Foam!$G$6:$G$8000=G" & r & ")*([AISR_FM_" & d & ".xlsm]Foam!$J$6:$J$8000=L" & r & "),0)," & c + 4 & ")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
            If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 36
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 End With
 
 
End Sub

Sub read_Ending_Inventory() 'Updating current ending inventory for this week

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim d As String
Dim loc As Worksheet

    Set loc = ThisWorkbook.Sheets("SB")      'loc=location
    
With loc
  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count

    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
  
    r = 12      'From Total Ending Inventory
    c = 48      'Starting Column, last week
    bycol = 48  'Ending Column, last week
    nofi = 1
    d = "09012019"

    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)

            'For Total Ending Inventory
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([EndingInventory_" & d & ".xlsm]EI!$A$2:$C$7000, MATCH(1,([EndingInventory_" & d & ".xlsm]EI!$A$2:$A$7000='SB'!G" & r & ")*([EndingInventory_" & d & ".xlsm]EI!$B$2:$B$7000='SB'!L" & r & "),0),3),0)"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
             If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = 0
             
             'For West Ending Inventory
            .Range(.Cells(r + 10, c), .Cells(r + 10, c)).FormulaArray = "=IFERROR(INDEX([EndingInventory_" & d & ".xlsm]EI!$A$2:$C$7000, MATCH(1,([EndingInventory_" & d & ".xlsm]EI!$A$2:$A$7000='SB'!G" & r + 10 & ")*([EndingInventory_" & d & ".xlsm]EI!$B$2:$B$7000='SB'!L" & r + 10 & "),0),3),0)"
            .Range(.Cells(r + 10, c), .Cells(r + 10, c)).Copy
            .Range(.Cells(r + 10, c), .Cells(r + 10, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
             If .Range(.Cells(r + 10, c), .Cells(r + 10, c)).Value = 0 Then .Range(.Cells(r + 10, c), .Cells(r + 10, c)).Value = 0
             
            'For East Ending Inventory
            .Range(.Cells(r + 19, c), .Cells(r + 19, c)).FormulaArray = "=IFERROR(INDEX([EndingInventory_" & d & ".xlsm]EI!$A$2:$C$7000, MATCH(1,([EndingInventory_" & d & ".xlsm]EI!$A$2:$A$7000='SB'!G" & r + 19 & ")*([EndingInventory_" & d & ".xlsm]EI!$B$2:$B$7000='SB'!L" & r + 19 & "),0),3),0)"
            .Range(.Cells(r + 19, c), .Cells(r + 19, c)).Copy
            .Range(.Cells(r + 19, c), .Cells(r + 19, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
             If .Range(.Cells(r + 19, c), .Cells(r + 19, c)).Value = 0 Then .Range(.Cells(r + 19, c), .Cells(r + 19, c)).Value = 0
            
    
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 12
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 End With
 
 
End Sub

Sub read_DirectImport_ETD()

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim sdate As String
Dim loc As Worksheet
Dim cname, cname2 As String

    Set loc = ThisWorkbook.Sheets("SB")
    
With loc
  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count
  
    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
   
    r = 36              'First row for Direct Import
    c = 58              'Starting column
    bycol = 71          'Ending column
    nofi = 1            'Number of Item
    sdate = "12212018"  'File date of MasterPO
    
    Do While (c < bycol + 1)  ' Loop excute from first column to end column
        Do While (nofi < ((LastRow - 5) / 52) + 1)
        
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4
            
            'For (AMZ) Direct Import
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([MasterPO_" & sdate & ".xlsm]DI_SISR!$A$2:$C$10000, MATCH(1,([MasterPO_" & sdate & ".xlsm]DI_SISR!$A$2:$A$10000=" & cname & ")*([MasterPO_" & sdate & ".xlsm]DI_SISR!$B$2:$B$10000=H" & r & "),0),3),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
             'If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""

        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 36
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
    
 End With
 
 
End Sub
Sub read_TEMP_DirectImport_ETD()

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim sdate As String
Dim loc As Worksheet
Dim cname, cname2 As String

    Set loc = ThisWorkbook.Sheets("SB")
    
With loc
  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count
  
    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False

    r = 36              'First row for Direct Import
    c = 14              'Starting column
    bycol = 59          'Ending column
    nofi = 1            'Number of Item
    sdate = "09132017"  'File date of MasterPO
    
    Do While (c < bycol + 1)  ' Loop excute from first column to end column
        Do While (nofi < ((LastRow - 5) / 52) + 1)
        
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4
            
            'For (AMZ) Direct Import
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([DI_Master_DB_" & sdate & ".xlsm]M!$A$2:$C$5000, MATCH(1,([DI_Master_DB_" & sdate & ".xlsm]M!$A$2:$A$5000=" & cname & ")*([DI_Master_DB_" & sdate & ".xlsm]M!$B$2:$B$5000=H" & r & "),0),3),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
             'If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""

        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 36
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
    
 End With
 
 
End Sub


Sub read_ABC_report()

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim loc As Worksheet
Dim Var As String

    Set loc = ThisWorkbook.Sheets("SB")

With loc
    LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  
    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False

    r = 6              'First row of Zinus SKU
    c = 7              'Column
    nofi = 1

Do While (nofi < ((LastRow - 5) / 52) + 1)

    Var = Application.IfError(Application.VLookup(.Cells(r, c), Range("[ABC_Report.xlsx]ABC!$A$2:$D$1500"), 4, False), "Null")
    If Var = "A" Then
    .Range(.Cells(r, c), .Cells(r + 52, c)).Interior.ColorIndex = 38
    ElseIf Var = "B" Then
    .Range(.Cells(r, c), .Cells(r + 52, c)).Interior.ColorIndex = 44
    ElseIf Var = "C" Then
    .Range(.Cells(r, c), .Cells(r + 52, c)).Interior.ColorIndex = 15
    ElseIf Var = "NA" Then
    .Range(.Cells(r, c), .Cells(r + 52, c)).Interior.ColorIndex = 38
    ElseIf Var = "NB" Then
    .Range(.Cells(r, c), .Cells(r + 52, c)).Interior.ColorIndex = 44
    ElseIf Var = "NC" Then
    .Range(.Cells(r, c), .Cells(r + 52, c)).Interior.ColorIndex = 15
    ElseIf Var = "Null" Then
    .Range(.Cells(r, c), .Cells(r + 52, c)).Interior.ColorIndex = 37
    End If
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True

    r = r + 52
    nofi = nofi + 1
    Loop

End With
 
End Sub

Sub Updating_Actual_Sales_All_Auto() 'need to run ALL first then others, and wmt.

Dim r, c, bycol, nofi As Integer    'r indicates row, c indicates column
Dim LastRow, LastColumn As Long
Dim loc As Worksheet
Dim cname, cname2 As String
Dim path As String
Dim openWb As Workbook
Dim openWs As Worksheet

path = "C:\Users\Young\Desktop\SISRUpdate\SH.xlsx"

Set openWb = Workbooks.Open(path)
Set openWs = openWb.Sheets("all")
Set loc = ThisWorkbook.Sheets("SB")  'loc=location

With openWs
With loc
  LastRow = .Cells(.Rows.Count, "F").End(xlUp).Row
  LastColumn = .Range("F1").CurrentRegion.Columns.Count
  
    Application.Calculation = xlCalculationManual   'speed up
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False

    r = 34      'From AMAZON
    c = 47      'Starting Column (Edit this every week)
    bycol = 49  'Ending Column (Edit this every week)
    nofi = 1    'Number of Item
    
    Do While (c < bycol + 1)                        '+1 to include bycol
        
        Do While (nofi < ((LastRow - 5) / 52) + 1)  'Subtract 5 to skip the first five rows which are a header of table. Then divide by rows(52) needed for a sub-table of one item.
            
            Do While (r < 52 * nofi - 17 + 1)
                
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4
            
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([SH.xlsx]all!$A$4:$DG$5000, MATCH(1,([SH.xlsx]all!$A$4:$A$5000='FR'!G" & r & ")*([SH.xlsx]all!$B$4:$B$5000='FR'!L" & r & "),0), MATCH(" & cname & ",([SH.xlsx]all!$A$1:$DG$1),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
            If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
             
            r = r + 1
              
            Loop
            r = r + 1 'To skip Amazon-DI
            
            Do While (r < 52 * nofi - 1 + 1)        'An=A1+(n-1)*D=51+(n-1)*52=52n-1, from Row 34 (Amazon) to Row 51 (zinus.com)
            
            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([SH.xlsx]all!$A$4:$DG$5000, MATCH(1,([SH.xlsx]all!$A$4:$A$5000='FM'!G" & r & ")*([SH.xlsx]all!$B$4:$B$5000='FM'!L" & r & "),0)," & c + 4 & "),"""")"
            'Check "c - x" at the end of above formula.
            
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4
            
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([SH.xlsx]all!$A$4:$DG$5000, MATCH(1,([SH.xlsx]all!$A$4:$A$5000='FR'!G" & r & ")*([SH.xlsx]all!$B$4:$B$5000='FR'!L" & r & "),0), MATCH(" & cname & ",([SH.xlsx]all!$A$1:$DG$1),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
            If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
    
            r = r + 1 'Row 34 to 51
            Loop

        r = r + 34      'Out at 52, to next Amazon row which is 86
        nofi = nofi + 1 'To next item
        Loop
    
    r = 34      'Back to FIRST channel(Amazon)
    nofi = 1    'Reset as default to repeat the loop
    c = c + 1   'Start from next column
    Loop
    
 End With
 End With
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
    ActiveWorkbook.Close SaveChanges:=True
 
End Sub

Sub Updating_Actual_Sales_WE_Auto()

Dim c, r, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim loc As Worksheet
Dim cname, cname2 As String
Dim path As String
Dim openWb As Workbook
Dim openWs As Worksheet

path = "C:\Users\Young\Desktop\SISRUpdate\SH_West_East.xlsx"

Set openWb = Workbooks.Open(path)
Set openWs = openWb.Sheets("SHWE")

Set loc = ThisWorkbook.Sheets("SB")

With openWs
With loc
  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count
  
    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False


    c = 47      'Starting Column
    bycol = 49  'Ending Column
    nofi = 1
    r = 16
    
    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
                      
        cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
        cname = cname2 & "" & 4 '4 indicates row 4
                    
        'West Actual
        .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([SH_West_East.xlsx]SHWE!$A$4:$DG$2500, MATCH(1,([SH_West_East.xlsx]SHWE!$A$4:$A$2500=G" & r & ")*([SH_West_East.xlsx]SHWE!$B$4:$B$2500=L" & r & "),0), MATCH(" & cname & ",([SH_West_East.xlsx]SHWE!$A$1:$DG$1),0)),0)"
        .Range(.Cells(r, c), .Cells(r, c)).Copy
        .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
        Application.CutCopyMode = False
            
        'If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
                
        'East Actual
        .Range(.Cells(r + 9, c), .Cells(r + 9, c)).FormulaArray = "=IFERROR(INDEX([SH_West_East.xlsx]SHWE!$A$4:$DG$2500, MATCH(1,([SH_West_East.xlsx]SHWE!$A$4:$A$2500=G" & r + 9 & ")*([SH_West_East.xlsx]SHWE!$B$4:$B$2500=L" & r + 9 & "),0), MATCH(" & cname & ",([SH_West_East.xlsx]SHWE!$A$1:$DG$1),0)),0)"
        .Range(.Cells(r + 9, c), .Cells(r + 9, c)).Copy
        .Range(.Cells(r + 9, c), .Cells(r + 9, c)).PasteSpecial (xlPasteValues)
        Application.CutCopyMode = False
            
        'If .Range(.Cells(r + 9, c), .Cells(r + 9, c)).Value = 0 Then .Range(.Cells(r + 9, c), .Cells(r + 9, c)).Value = ""
              
                
        r = r + 52
        nofi = nofi + 1
        Loop
    
    nofi = 1
    r = 16
    c = c + 1
    Loop
    
 End With
 End With
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
    ActiveWorkbook.Close SaveChanges:=True
 
End Sub

Sub read_F_AMAZON_Auto() 'Loading forecast numbers from account manager's sisr

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim d As String
Dim loc As Worksheet
Dim cname, cname2 As String
Dim path As String
Dim openWb As Workbook
Dim openWs As Worksheet

path = "C:\Users\Young\Desktop\SISRUpdate\AMAZON_02202018.xlsm"

Set openWb = Workbooks.Open(path)
Set openWs = openWb.Sheets("Demand")
Set loc = ThisWorkbook.Sheets("SB")  'loc=location

With openWs
With loc
  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count

    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
  
    r = 34      'From Costco
    c = 46      'Starting Column
    bycol = 58  'Ending Column
    nofi = 1
    d = "02202018"

    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4
            
            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([COSTCOCOM_" & sdate & ".xlsm]Demand!$A$4:$BW$1000, MATCH(1,([COSTCOCOM_" & sdate & ".xlsm]Demand!$D$4:$D$1000=G" & r & ")*([COSTCOCOM_" & sdate & ".xlsm]Demand!$F$4:$F$1000=L" & r & "),0)," & c + 97 & "),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([AMAZON_" & d & ".xlsm]Demand!$A$4:$CL$2000, MATCH(1,([AMAZON_" & d & ".xlsm]Demand!$B$4:$B$2500=G" & r & ")*([AMAZON_" & d & ".xlsm]Demand!$G$4:$G$2500=L" & r & "),0),MATCH(" & cname & ",([AMAZON_" & d & ".xlsm]Demand!$A$2:$CL$2),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
             If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
    
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 34
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 End With
 End With
 Workbooks("AMAZON_02202018.xlsm").Close SaveChanges:=False
 ActiveWorkbook.Save

End Sub
Sub read_F_COSTCO_Auto() 'Loading forecast numbers from account manager's sisr

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim d As String
Dim loc As Worksheet
Dim cname, cname2 As String
Dim path As String
Dim openWb As Workbook
Dim openWs As Worksheet

'0. Elvis Definination
Dim startDate, startWK As Date
Dim startWK_val As Long
Dim channel_c, channel_bycol As Integer
Dim lookup_range, channel_lookup_range As Range

'1. Set speed up model
    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
    
'2. Set workbook/worksheet
    Set loc = ThisWorkbook.Sheets("SB")  'loc=location

'3. Open File
    path = "C:\Users\Elvis Ma\Desktop\Weekly Work\Actual Sales\costcocom_testing.xlsm"
    Set openWb = Workbooks.Open(path)
    Set openWs = openWb.Sheets("Demand")
    
'4. get date range
    startDate = Date
    startWK = startDate - Weekday(startDate, 2)
    startWK_val = DateValue(startWK)

With openWs
With loc

'5. define row, column, lookup range

  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count
  Set lookup_range = .Range("A4:DL4")                 'need to be improved
  Set channel_lookup_range = openWs.Range("A2:GQ2")   'need to be improved

'6. lookup to find columns to update
  c = Application.WorksheetFunction.Match(startWK_val, lookup_range, 0)
  bycol = c + 17   'to cover 17 weeks rolling forecast
  
  channel_c = Application.WorksheetFunction.Match(startWK_val, channel_lookup_range, 0)
  channel_bycol = channel_c + 17   'to cover 17 weeks rolling forecast
  
  
  
    r = 39      'From Costco
   
    nofi = 1
    d = "testing"

    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4
            
            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([COSTCOCOM_" & sdate & ".xlsm]Demand!$A$4:$BW$1000, MATCH(1,([COSTCOCOM_" & sdate & ".xlsm]Demand!$D$4:$D$1000=G" & r & ")*([COSTCOCOM_" & sdate & ".xlsm]Demand!$F$4:$F$1000=L" & r & "),0)," & c + 97 & "),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([costcocom_" & d & ".xlsm]Demand!$A$4:$GQ$500, MATCH(1,([costcocom_" & d & ".xlsm]Demand!$B$4:$B$500=G" & r & ")*([costcocom_" & d & ".xlsm]Demand!$D$4:$D$500=L" & r & "),0),MATCH(" & cname & ",([COSTCOCOM_" & d & ".xlsm]Demand!$A$2:$GQ$2),0)),"""")"
            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX(openWs.Range(.cells(4,channel_c),.cells(1000,channel_bycol)), MATCH(1,(openWs.Range(.cells(4,2),.cells(1000,2))=G" & r & ")*(openWs.Range(.cells(4,4),.cells(1000,4))=L" & r & "),0),MATCH(" & cname & ",openWs.Range(.cells(2,channel_c),.cells(2,channel_bycol)),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
             If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
    
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 39
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 
 End With
 End With
 Workbooks("costcocom_testing.xlsm").Close SaveChanges:=False
 ActiveWorkbook.Save
 
End Sub
Sub read_F_HomeDepot_Auto() 'Loading forecast numbers from account manager's sisr

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim d As String
Dim loc As Worksheet
Dim cname, cname2 As String
Dim path As String
Dim openWb As Workbook
Dim openWs As Worksheet


'0. Elvis Definination
Dim startDate, startWK As Date
Dim startWK_val As Long
Dim lookup_range As Range

'1. Set speed up model
    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
    
'2. Set workbook/worksheet
    Set loc = ThisWorkbook.Sheets("SB")  'loc=location

'3. Open File
    path = "C:\Users\Elvis Ma\Desktop\Weekly Work\Actual Sales\HomeDepot_testing.xlsm"
    Set openWb = Workbooks.Open(path)
    Set openWs = openWb.Sheets("Demand")
    
'4. get date range
    startDate = Date
    startWK = startDate - Weekday(startDate, 2)
    startWK_val = DateValue(startWK)

With openWs
With loc

'5. define row, column, lookup range

  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count
  Set lookup_range = .Range("A4:DL4") 'need to be improved

'6. lookup to find columns to update
  c = Application.WorksheetFunction.Match(startWK_val, lookup_range, 0)
  bycol = c + 17   'to cover 17 weeks rolling forecast
  
    r = 40      'From HomeDepot

    nofi = 1
    d = "testing"

    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4

            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([HOMEDEPOT_" & sdate & ".xlsm]Demand!$A$4:$EF$1000, MATCH(1,([HOMEDEPOT_" & sdate & ".xlsm]Demand!$D$4:$D$1000=G" & r & ")*([HOMEDEPOT_" & sdate & ".xlsm]Demand!$F$4:$F$1000=L" & r & "),0)," & c + 97 & "),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([HomeDepot_" & d & ".xlsm]Demand!$A$4:$DG$6000, MATCH(1,([HomeDepot_" & d & ".xlsm]Demand!$D$4:$D$6000=G" & r & ")*([HomeDepot_" & d & ".xlsm]Demand!$G$4:$G$6000=L" & r & "),0) ,MATCH(" & cname & ",([HomeDepot_" & d & ".xlsm]Demand!$A$2:$DG$2),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
             If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
    
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 40
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 End With
 End With
 Workbooks("HomeDepot_testing.xlsm").Close SaveChanges:=False
 ActiveWorkbook.Save
 
End Sub
Sub read_F_Overstock_Auto() 'Loading forecast numbers from account manager's sisr

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim d As String
Dim loc As Worksheet
Dim cname, cname2 As String
Dim path As String
Dim openWb As Workbook
Dim openWs As Worksheet


'0. Elvis Definination
Dim startDate, startWK As Date
Dim startWK_val As Long
Dim lookup_range As Range

'1. Set speed up model
    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
    
'2. Set workbook/worksheet
    Set loc = ThisWorkbook.Sheets("SB")  'loc=location

'3. Open File
    path = "C:\Users\Elvis Ma\Desktop\Weekly Work\Actual Sales\O_testing.xlsm"
    Set openWb = Workbooks.Open(path)
    Set openWs = openWb.Sheets("Demand")
    
'4. get date range
    startDate = Date
    startWK = startDate - Weekday(startDate, 2)
    startWK_val = DateValue(startWK)

With openWs
With loc

'5. define row, column, lookup range

  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count
  Set lookup_range = .Range("A4:DL4") 'need to be improved

'6. lookup to find columns to update
  c = Application.WorksheetFunction.Match(startWK_val, lookup_range, 0)
  bycol = c + 17   'to cover 17 weeks rolling forecast
  r = 44      'From Overstock
  nofi = 1
  d = "testing"

    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4

            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([OVERSTOCK_" & sdate & ".xlsm]Demand!$A$4:$EF$1000, MATCH(1,([OVERSTOCK_" & sdate & ".xlsm]Demand!$D$4:$D$1000=G" & r & ")*([OVERSTOCK_" & sdate & ".xlsm]Demand!$F$4:$F$1000=L" & r & "),0)," & c + 97 & "),"""")"
            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([OVERSTOCK_" & d & ".xlsm]Demand!$A$4:$EF$1000, MATCH(1,([OVERSTOCK_" & d & ".xlsm]Demand!$D$4:$D$1000=G" & r & ")*([OVERSTOCK_" & d & ".xlsm]Demand!$F$4:$F$1000=L" & r & "),0) ,MATCH(" & cname & ",([OVERSTOCK_" & d & ".xlsm]Demand!$A$2:$EF$2),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([O_" & d & ".xlsm]Demand!$A$4:$JC$5000, MATCH(1,([O_" & d & ".xlsm]Demand!$D$4:$D$5000=G" & r & ")*([O_" & d & ".xlsm]Demand!$I$4:$I$5000=L" & r & "),0) ,MATCH(" & cname & ",([O_" & d & ".xlsm]Demand!$A$2:$JC$2),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
            If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
    
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 44
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 End With
 End With
 Workbooks("O_testing.xlsm").Close SaveChanges:=False
 ActiveWorkbook.Save
 
End Sub
Sub read_F_SAMSCLUB_Auto() 'Loading forecast numbers from account manager's sisr

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim d As String
Dim loc As Worksheet
Dim cname, cname2 As String
Dim path As String
Dim openWb As Workbook
Dim openWs As Worksheet

'0. Elvis Definination
Dim startDate, startWK As Date
Dim startWK_val As Long
Dim lookup_range As Range

'1. Set speed up model
    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
    
'2. Set workbook/worksheet
    Set loc = ThisWorkbook.Sheets("SB")  'loc=location

'3. Open File
    path = "C:\Users\Elvis Ma\Desktop\Weekly Work\Actual Sales\samsclub_testing.xlsb"
    Set openWb = Workbooks.Open(path)
    Set openWs = openWb.Sheets("Demand")
    
'4. get date range
    startDate = Date
    startWK = startDate - Weekday(startDate, 2)
    startWK_val = DateValue(startWK)

With openWs
With loc

'5. define row, column, lookup range

  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count
  Set lookup_range = .Range("A4:DL4") 'need to be improved

'6. lookup to find columns to update
  c = Application.WorksheetFunction.Match(startWK_val, lookup_range, 0)
  bycol = c + 17   'to cover 17 weeks rolling forecast
  
    r = 45      'From Samsclub
   
    nofi = 1
    d = "testing"

    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4

            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([SAMSCLUB_" & sdate & ".xlsm]Demand!$A$4:$EE$1000, MATCH(1,([SAMSCLUB_" & sdate & ".xlsm]Demand!$D$4:$D$1000=G" & r & ")*([SAMSCLUB_" & sdate & ".xlsm]Demand!$E$4:$E$1000=L" & r & "),0)," & c + 96 & "),"""")"
            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([SAMSCLUB_" & d & ".xlsb]Demand!$A$4:$GM$1500, MATCH(1,([samsclub_" & d & ".xlsx]Demand!$B$4:$B$1500=G" & r & ")*([samsclub_" & d & ".xlsx]Demand!$D$4:$D$1500=L" & r & "),0) ,MATCH(" & cname & ",([samsclub_" & d & ".xlsx]Demand!$A$2:$GM$2),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([samsclub_" & d & ".xlsb]Demand!$A$4:$FH$1500, MATCH(1,([samsclub_" & d & ".xlsb]Demand!$B$4:$B$1500=G" & r & ")*([samsclub_" & d & ".xlsb]Demand!$D$4:$D$1500=L" & r & "),0) ,MATCH(" & cname & ",([samsclub_" & d & ".xlsb]Demand!$A$2:$FH$2),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
             If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
    
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 45
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 End With
 End With
 
 Workbooks("samsclub_testing.xlsb").Close SaveChanges:=False
 ActiveWorkbook.Save
 
End Sub
Sub read_F_Target_Auto() 'Loading forecast numbers from account manager's sisr

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim d As String
Dim loc As Worksheet
Dim cname, cname2 As String
Dim path As String
Dim openWb As Workbook
Dim openWs As Worksheet


'0. Elvis Definination
Dim startDate, startWK As Date
Dim startWK_val As Long
Dim lookup_range As Range

'1. Set speed up model
    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
    
'2. Set workbook/worksheet
    Set loc = ThisWorkbook.Sheets("SB")  'loc=location

'3. Open File
    path = "C:\Users\Elvis Ma\Desktop\Weekly Work\Actual Sales\target_testing.xlsm"
    Set openWb = Workbooks.Open(path)
    Set openWs = openWb.Sheets("Demand")
    
'4. get date range
    startDate = Date
    startWK = startDate - Weekday(startDate, 2)
    startWK_val = DateValue(startWK)

With openWs
With loc

'5. define row, column, lookup range

  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count
  Set lookup_range = .Range("A4:DL4") 'need to be improved

'6. lookup to find columns to update
    c = Application.WorksheetFunction.Match(startWK_val, lookup_range, 0)
    bycol = c + 17   'to cover 17 weeks rolling forecast
    
    r = 48      'From Target

    nofi = 1
    d = "testing"

    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4

            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([TARGET_" & sdate & ".xlsm]Demand!$A$4:$DX$500, MATCH(1,([TARGET_" & sdate & ".xlsm]Demand!$D$4:$D$500=G" & r & ")*([TARGET_" & sdate & ".xlsm]Demand!$F$4:$F$500=L" & r & "),0)," & c + 97 & "),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([TARGET_" & d & ".xlsm]Demand!$A$4:$JG$1000, MATCH(1,([TARGET_" & d & ".xlsm]Demand!$D$4:$D$1000=G" & r & ")*([TARGET_" & d & ".xlsm]Demand!$G$4:$G$1000=L" & r & "),0) ,MATCH(" & cname & ",([TARGET_" & d & ".xlsm]Demand!$A$2:$JG$2),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
             If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
    
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 48
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 End With
 End With
 Workbooks("target_testing.xlsm").Close SaveChanges:=False
 ActiveWorkbook.Save
 
End Sub
Sub read_F_Wayfair_Auto() 'Loading forecast numbers from account manager's sisr

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim d As String
Dim loc As Worksheet
Dim cname, cname2 As String
Dim path As String
Dim openWb As Workbook
Dim openWs As Worksheet

'0. Elvis Definination
Dim startDate, startWK As Date
Dim startWK_val As Long
Dim lookup_range As Range

'1. Set speed up model
    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
    
'2. Set workbook/worksheet
    Set loc = ThisWorkbook.Sheets("SB")  'loc=location

'3. Open File
    path = "C:\Users\Elvis Ma\Desktop\Weekly Work\Actual Sales\USWayfair_testing.xlsm"
    Set openWb = Workbooks.Open(path)
    Set openWs = openWb.Sheets("Master")
    
'4. get date range
    startDate = Date
    startWK = startDate - Weekday(startDate, 2)
    startWK_val = DateValue(startWK)

With openWs
With loc

'5. define row, column, lookup range

  LastRow = .Cells(.Rows.Count, "G").End(xlUp).Row
  LastColumn = .Range("G1").CurrentRegion.Columns.Count
  Set lookup_range = .Range("A4:DL4") 'need to be improved

'6. lookup to find columns to update
  c = Application.WorksheetFunction.Match(startWK_val, lookup_range, 0)
  bycol = c + 25   'to cover 25 weeks rolling forecast
  
    r = 49      'From Wayfair
   
    nofi = 1
    d = "testing"

    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4

            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([TARGET_" & sdate & ".xlsm]Demand!$A$4:$DX$700, MATCH(1,([TARGET_" & sdate & ".xlsm]Demand!$D$4:$D$700=G" & r & ")*([TARGET_" & sdate & ".xlsm]Demand!$F$4:$F$700=L" & r & "),0)," & c + 97 & "),"""")"
            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([USWayfair_" & d & ".xlsm]Master!$A$4:$CK$5000, MATCH(1,([USWayfair_" & d & ".xlsm]Master!$D$4:$D$5000=G" & r & ")*([USWayfair_" & d & ".xlsm]Master!$F$4:$F$5000=""ZINUS DDS""),0) ,MATCH(" & cname & ",([USWayfair_" & d & ".xlsm]Master!$A$3:$CK$3),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([USWayfair_" & d & ".xlsm]Master!$BF$4:$DE$6000, MATCH(1,([USWayfair_" & d & ".xlsm]Master!$D$4:$D$6000=G" & r & ")*([USWayfair_" & d & ".xlsm]Master!$F$4:$F$6000=""ZINUS DDS""),0) ,MATCH(" & cname & ",([USWayfair_" & d & ".xlsm]Master!$BF$3:$DE$3),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
             If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
    
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 49
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
    
 End With
 End With
 
 Workbooks("USWayfair_testing.xlsm").Close SaveChanges:=False
 ActiveWorkbook.Save
 
 
End Sub

Sub read_F_WMT_Auto() 'Loading forecast numbers from account manager's sisr

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim d As String
Dim loc As Worksheet
Dim cname, cname2 As String
Dim path As String
Dim openWb As Workbook
Dim openWs As Worksheet

'0. Elvis Definination
Dim startDate, startWK As Date
Dim startWK_val As Long
Dim lookup_range As Range

'1. Set speed up model
    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
    
'2. Set workbook/worksheet
    Set loc = ThisWorkbook.Sheets("SB")  'loc=location

'3. Open File
    path = "C:\Users\Elvis Ma\Desktop\Weekly Work\Actual Sales\WMT_testing.xlsm"
    Set openWb = Workbooks.Open(path)
    Set openWs = openWb.Sheets("Demand")
    
'4. get date range
    startDate = Date
    startWK = startDate - Weekday(startDate, 2)
    startWK_val = DateValue(startWK)

With openWs
With loc

'5. define row, column, lookup range

  LastRow = .Cells(.Rows.Count, "G").End(xlUp).Row
  LastColumn = .Range("G1").CurrentRegion.Columns.Count
  Set lookup_range = .Range("A4:DL4") 'need to be improved

'6. lookup to find columns to update
  c = Application.WorksheetFunction.Match(startWK_val, lookup_range, 0)
  bycol = c + 17   'to cover 17 weeks rolling forecast
    
    r = 50      'From WMT
    nofi = 1
    d = "testing"

    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4

            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([WMT_" & sdate & ".xlsm]Demand!$A$4:$FM$1000, MATCH(1,([WMT_" & sdate & ".xlsm]Demand!$D$4:$D$1000=G" & r & ")*([WMT_" & sdate & ".xlsm]Demand!$F$4:$F$1000=L" & r & "),0)," & c + 97 & "),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([WMT_" & d & ".xlsm]Demand!$A$4:$HJ$4000, MATCH(1,([WMT_" & d & ".xlsm]Demand!$D$4:$D$4000=G" & r & ")*([WMT_" & d & ".xlsm]Demand!$G$4:$G$4000=L" & r & "),0) ,MATCH(" & cname & ",([WMT_" & d & ".xlsm]Demand!$A$3:$HJ$3),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
             If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
    
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 50
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
    
 End With
 End With
 
 Workbooks("WMT_testing.xlsm").Close SaveChanges:=False
 ActiveWorkbook.Save
 
End Sub
Sub read_F_ZINUS_Auto() 'Loading forecast numbers from account manager's sisr

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim d As String
Dim loc As Worksheet
Dim cname, cname2 As String
Dim path As String
Dim openWb As Workbook
Dim openWs As Worksheet

'0. Elvis Definination
Dim startDate, startWK As Date
Dim startWK_val As Long
Dim lookup_range As Range

'1. Set speed up model
    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
    
'2. Set workbook/worksheet
    Set loc = ThisWorkbook.Sheets("SB")  'loc=location

'3. Open File
    path = "C:\Users\Elvis Ma\Desktop\Weekly Work\Actual Sales\ZINUSCOM_testing.xlsm"
    Set openWb = Workbooks.Open(path)
    Set openWs = openWb.Sheets("Demand")
    
'4. get date range
    startDate = Date
    startWK = startDate - Weekday(startDate, 2)
    startWK_val = DateValue(startWK)

With openWs
With loc

'5. define row, column, lookup range

  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count
  Set lookup_range = .Range("A4:DL4") 'need to be improved

'6. lookup to find columns to update
  c = Application.WorksheetFunction.Match(startWK_val, lookup_range, 0)
  bycol = c + 17   'to cover 17 weeks rolling forecast
  
    r = 51      'From ZINUS
    nofi = 1
    d = "testing"

    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4

            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([ZINUSCOM_" & sdate & ".xlsm]Demand!$A$4:$DS$1000, MATCH(1,([ZINUSCOM_" & sdate & ".xlsm]Demand!$D$4:$D$1000=G" & r & ")*([ZINUSCOM_" & sdate & ".xlsm]Demand!$F$4:$F$1000=L" & r & "),0)," & c + 97 & "),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([ZINUSCOM_" & d & ".xlsm]Demand!$A$4:$CF$5000, MATCH(1,([ZINUSCOM_" & d & ".xlsm]Demand!$D$4:$D$5000=G" & r & ")*([ZINUSCOM_" & d & ".xlsm]Demand!$F$4:$F$5000=L" & r & "),0) ,MATCH(" & cname & ",([ZINUSCOM_" & d & ".xlsm]Demand!$A$2:$CF$2),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
             If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
    
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 51
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 End With
 End With
 Workbooks("ZINUSCOM_testing.xlsm").Close SaveChanges:=False
 ActiveWorkbook.Save
 
End Sub

Sub read_F_Macys() 'Loading forecast numbers from account manager's sisr

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim d As String
Dim loc As Worksheet
Dim cname, cname2 As String

    Set loc = ThisWorkbook.Sheets("SB")      'loc=location
    
With loc
  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count

    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
  
    r = 52      'From Overstock
    c = 68     'Starting Column
    bycol = 90  'Ending Column
    nofi = 1
    d = "01222019"

    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4

            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([OVERSTOCK_" & sdate & ".xlsm]Demand!$A$4:$EF$1000, MATCH(1,([OVERSTOCK_" & sdate & ".xlsm]Demand!$D$4:$D$1000=G" & r & ")*([OVERSTOCK_" & sdate & ".xlsm]Demand!$F$4:$F$1000=L" & r & "),0)," & c + 97 & "),"""")"
            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([OVERSTOCK_" & d & ".xlsm]Demand!$A$4:$EF$1000, MATCH(1,([OVERSTOCK_" & d & ".xlsm]Demand!$D$4:$D$1000=G" & r & ")*([OVERSTOCK_" & d & ".xlsm]Demand!$F$4:$F$1000=L" & r & "),0) ,MATCH(" & cname & ",([OVERSTOCK_" & d & ".xlsm]Demand!$A$2:$EF$2),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([MACYS_" & d & ".xlsm]Demand!$A$4:$IG$5000, MATCH(1,([MACYS_" & d & ".xlsm]Demand!$D$4:$D$5000=G" & r & ")*([MACYS_" & d & ".xlsm]Demand!$G$4:$G$5000=L" & r & "),0) ,MATCH(" & cname & ",([MACYS_" & d & ".xlsm]Demand!$A$2:$IG$2),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
             If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
    
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 52
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 End With
 
 
End Sub

Sub read_F_Macys_Auto() 'Loading forecast numbers from account manager's sisr

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim d As String
Dim loc As Worksheet
Dim cname, cname2 As String

'0. Elvis Definination
Dim startDate, startWK As Date
Dim startWK_val As Long
Dim lookup_range As Range

'1. Set speed up model
    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
    
'2. Set workbook/worksheet
    Set loc = ThisWorkbook.Sheets("SB")  'loc=location

'3. Open File
    path = "C:\Users\Elvis Ma\Desktop\Weekly Work\Actual Sales\MACYS_testing.xlsm"
    Set openWb = Workbooks.Open(path)
    Set openWs = openWb.Sheets("Demand")
    
'4. get date range
    startDate = Date
    startWK = startDate - Weekday(startDate, 2)
    startWK_val = DateValue(startWK)

With openWs
With loc

'5. define row, column, lookup range

  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count
  Set lookup_range = .Range("A4:DL4") 'need to be improved

'6. lookup to find columns to update
  c = Application.WorksheetFunction.Match(startWK_val, lookup_range, 0)
  bycol = c + 17   'to cover 17 weeks rolling forecast

  
    r = 52      'From Overstock
    nofi = 1
    d = "testing"

    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4

            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([OVERSTOCK_" & sdate & ".xlsm]Demand!$A$4:$EF$1000, MATCH(1,([OVERSTOCK_" & sdate & ".xlsm]Demand!$D$4:$D$1000=G" & r & ")*([OVERSTOCK_" & sdate & ".xlsm]Demand!$F$4:$F$1000=L" & r & "),0)," & c + 97 & "),"""")"
            '.Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([OVERSTOCK_" & d & ".xlsm]Demand!$A$4:$EF$1000, MATCH(1,([OVERSTOCK_" & d & ".xlsm]Demand!$D$4:$D$1000=G" & r & ")*([OVERSTOCK_" & d & ".xlsm]Demand!$F$4:$F$1000=L" & r & "),0) ,MATCH(" & cname & ",([OVERSTOCK_" & d & ".xlsm]Demand!$A$2:$EF$2),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([MACYS_" & d & ".xlsm]Demand!$A$4:$IG$5000, MATCH(1,([MACYS_" & d & ".xlsm]Demand!$D$4:$D$5000=G" & r & ")*([MACYS_" & d & ".xlsm]Demand!$G$4:$G$5000=L" & r & "),0) ,MATCH(" & cname & ",([MACYS_" & d & ".xlsm]Demand!$A$2:$IG$2),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
             If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
    
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 52
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 
 End With
 End With
 Workbooks("MACYS_testing.xlsm").Close SaveChanges:=False
 ActiveWorkbook.Save
 
 
End Sub


Sub read_F_DDS()

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim d As String
Dim loc As Worksheet
Dim cname, cname2 As String

    Set loc = ThisWorkbook.Sheets("SB")      'loc=location
    
With loc
  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count

    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
  
    r = 35     'AMZ Direct
    c = 66      'Starting Column
    bycol = 91 'Ending Column
    nofi = 1
    d = "01032019"

    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4

            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([AMZ_Weekly_" & d & ".xlsx]DDS_Weekly!$G$3:$BA$2000, MATCH(G" & r & ",([AMZ_Weekly_" & d & ".xlsx]DDS_Weekly!$E$3:$E$2000),0),MATCH(" & cname & ",([AMZ_Weekly_" & d & ".xlsx]DDS_Weekly!$G$2:$BA$2),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
            If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
    
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 35
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 End With
 
 
End Sub

Sub read_F_Direct()

Dim r, c, bycol, nofi As Integer
Dim LastRow, LastColumn As Long
Dim d As String
Dim loc As Worksheet
Dim cname, cname2 As String

    Set loc = ThisWorkbook.Sheets("SB")      'loc=location
    
With loc
  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  LastColumn = .Range("A1").CurrentRegion.Columns.Count

    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
  
    r = 37     'AMZ Direct
    c = 66      'Starting Column
    bycol = 91 'Ending Column
    nofi = 1
    d = "01032019"

    Do While (c < bycol + 1)
        Do While (nofi < ((LastRow - 5) / 52) + 1)
            
            cname2 = Replace(Split(Columns(c).Address, ":")(0), "$", "") 'column alphabet
            cname = cname2 & "" & 4 '4 indicates row 4

            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([AMZ_Weekly_" & d & ".xlsx]Direct_Weekly!$G$3:$BA$2000, MATCH(G" & r & ",([AMZ_Weekly_" & d & ".xlsx]Direct_Weekly!$E$3:$E$2000),0),MATCH(" & cname & ",([AMZ_Weekly_" & d & ".xlsx]Direct_Weekly!$G$2:$BA$2),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
            If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
            
    
        r = r + 52
        nofi = nofi + 1
        
        Loop
    
    r = 37
    nofi = 1
    c = c + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 End With
 
 
End Sub


Sub Combine_Update_FcstNum()

Dim csc, hd, os, sc, target, wf, wmt, zinus, macys, cmatch, c, bycol, nofi, cw As Integer
Dim LastRow, LastColumn As Long
Dim loc As Worksheet

Dim startDate, startWK As Date
Dim startWK_val As Long
Dim lookup_range As Range

    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
    
    Set loc = ThisWorkbook.Sheets("SB")
    
    startDate = Date
    startWK = startDate - Weekday(startDate, 2)
    startWK_val = DateValue(startWK)
    
  With loc
    LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
    LastColumn = .Range("A1").CurrentRegion.Columns.Count
    Set lookup_range = .Range("A4:DL4")   'Range setting need to be updated regularly
    
    csc = 39
    hd = 40
    os = 44
    sc = 45
    target = 48
    wf = 49
    wmt = 50
    zinus = 51
    macys = 52
    
    
    cmatch = Application.WorksheetFunction.Match(startWK_val, lookup_range, 0)
    
    c = cmatch
    bycol = cmatch + 25  'for all accounts
    nofi = 1
    cw = 2
    
  
    'Costco Forecast
    Do While (c < bycol + 1)
      Do While (nofi < ((LastRow - 5) / 52) + 1)
            .Range(.Cells(csc, c), .Cells(csc, c)).Formula = "=IFERROR(VLOOKUP(G" & csc & ",[FcstNum.xlsx]CSC!$A$2:$AA$1200," & cw & ", FALSE),0)"
            .Range(.Cells(csc, c), .Cells(csc, c)).Copy
            .Range(.Cells(csc, c), .Cells(csc, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
        
            If .Range(.Cells(csc, c), .Cells(csc, c)).Value = 0 Then .Range(.Cells(csc, c), .Cells(csc, c)).Value = ""

       csc = csc + 52
       nofi = nofi + 1
      Loop
      
      csc = 39
      nofi = 1
      c = c + 1
      cw = cw + 1
    
    Loop
    
    
    'Home Depot Forecast
    c = cmatch
    'bycol = c + 20
    nofi = 1
    cw = 2
     Do While (c < bycol + 1)
      Do While (nofi < ((LastRow - 5) / 52) + 1)
          .Range(.Cells(hd, c), .Cells(hd, c)).Formula = "=IFERROR(VLOOKUP(G" & hd & ",[FcstNum.xlsx]HD!$A$2:$AA$1200," & cw & ", FALSE),0)"
          .Range(.Cells(hd, c), .Cells(hd, c)).Copy
          .Range(.Cells(hd, c), .Cells(hd, c)).PasteSpecial (xlPasteValues)
          Application.CutCopyMode = False
        
          If .Range(.Cells(hd, c), .Cells(hd, c)).Value = 0 Then .Range(.Cells(hd, c), .Cells(hd, c)).Value = ""

       hd = hd + 52
       nofi = nofi + 1
    
      Loop
      hd = 40
      nofi = 1
      c = c + 1
      cw = cw + 1
    Loop
    
    
    'Overstock Forecast
    c = cmatch
    'bycol = c + 20
    nofi = 1
    cw = 2
     Do While (c < bycol + 1)
      Do While (nofi < ((LastRow - 5) / 52) + 1)
        .Range(.Cells(os, c), .Cells(os, c)).Formula = "=IFERROR(VLOOKUP(G" & os & ",[FcstNum.xlsx]OS!$A$2:$AA$1200," & cw & ", FALSE),0)"
        .Range(.Cells(os, c), .Cells(os, c)).Copy
        .Range(.Cells(os, c), .Cells(os, c)).PasteSpecial (xlPasteValues)
        Application.CutCopyMode = False
        
        If .Range(.Cells(os, c), .Cells(os, c)).Value = 0 Then .Range(.Cells(os, c), .Cells(os, c)).Value = ""

       os = os + 52
       nofi = nofi + 1
    
      Loop
      os = 44
      nofi = 1
      c = c + 1
      cw = cw + 1
    Loop
    
    
    'Walmart Forecast
    c = cmatch
    'bycol = c + 20
    nofi = 1
    cw = 2
     Do While (c < bycol + 1)
      Do While (nofi < ((LastRow - 5) / 52) + 1)
        .Range(.Cells(wmt, c), .Cells(wmt, c)).Formula = "=IFERROR(VLOOKUP(G" & wmt & ",[FcstNum.xlsx]WMT!$A$2:$AA$1200," & cw & ", FALSE),0)"
        .Range(.Cells(wmt, c), .Cells(wmt, c)).Copy
        .Range(.Cells(wmt, c), .Cells(wmt, c)).PasteSpecial (xlPasteValues)
        Application.CutCopyMode = False
        
        If .Range(.Cells(wmt, c), .Cells(wmt, c)).Value = 0 Then .Range(.Cells(wmt, c), .Cells(wmt, c)).Value = ""

       wmt = wmt + 52
       nofi = nofi + 1
    
      Loop
      wmt = 50
      nofi = 1
      c = c + 1
      cw = cw + 1
    Loop
    
    'SamsClub Forecast
    c = cmatch
    'bycol = c + 20
    nofi = 1
    cw = 2
     Do While (c < bycol + 1)
      Do While (nofi < ((LastRow - 5) / 52) + 1)
        .Range(.Cells(sc, c), .Cells(sc, c)).Formula = "=IFERROR(VLOOKUP(G" & sc & ",[FcstNum.xlsx]SC!$A$2:$AA$1200," & cw & ", FALSE),0)"
        .Range(.Cells(sc, c), .Cells(sc, c)).Copy
        .Range(.Cells(sc, c), .Cells(sc, c)).PasteSpecial (xlPasteValues)
        Application.CutCopyMode = False
        
        If .Range(.Cells(sc, c), .Cells(sc, c)).Value = 0 Then .Range(.Cells(sc, c), .Cells(sc, c)).Value = ""
       
       sc = sc + 52
       nofi = nofi + 1
      Loop
      sc = 45
      nofi = 1
      c = c + 1
      cw = cw + 1
    Loop
    
    
    'Target Forecast
    c = cmatch
    'bycol = c + 20
    nofi = 1
    cw = 2
     Do While (c < bycol + 1)
      Do While (nofi < ((LastRow - 5) / 52) + 1)
        .Range(.Cells(target, c), .Cells(target, c)).Formula = "=IFERROR(VLOOKUP(G" & target & ",[FcstNum.xlsx]Target!$A$2:$AA$1200," & cw & ", FALSE),0)"
        .Range(.Cells(target, c), .Cells(target, c)).Copy
        .Range(.Cells(target, c), .Cells(target, c)).PasteSpecial (xlPasteValues)
        Application.CutCopyMode = False
        
        If .Range(.Cells(target, c), .Cells(target, c)).Value = 0 Then .Range(.Cells(target, c), .Cells(target, c)).Value = ""
        
       target = target + 52
       nofi = nofi + 1
      Loop
      target = 48
      nofi = 1
      c = c + 1
      cw = cw + 1
    Loop
    
    
    'Wayfair DDS Forecast
    c = cmatch
    'bycol = c + 20
    nofi = 1
    cw = 2
     Do While (c < bycol + 1)
      Do While (nofi < ((LastRow - 5) / 52) + 1)
        .Range(.Cells(wf, c), .Cells(wf, c)).Formula = "=IFERROR(VLOOKUP(G" & wf & ",[FcstNum.xlsx]WFDDS!$A$2:$AA$1200," & cw & ", FALSE),0)"
        .Range(.Cells(wf, c), .Cells(wf, c)).Copy
        .Range(.Cells(wf, c), .Cells(wf, c)).PasteSpecial (xlPasteValues)
        Application.CutCopyMode = False
        
        If .Range(.Cells(wf, c), .Cells(wf, c)).Value = 0 Then .Range(.Cells(wf, c), .Cells(wf, c)).Value = ""
       wf = wf + 52
       nofi = nofi + 1
      Loop
      
      wf = 49
      nofi = 1
      c = c + 1
      cw = cw + 1
    Loop
    
    
     'Zinus.com Forecast
    c = cmatch
    'bycol = c + 20
    nofi = 1
    cw = 2
     Do While (c < bycol + 1)
      Do While (nofi < ((LastRow - 5) / 52) + 1)
        .Range(.Cells(zinus, c), .Cells(zinus, c)).Formula = "=IFERROR(VLOOKUP(G" & zinus & ",[FcstNum.xlsx]Zinus!$A$2:$AA$1200," & cw & ", FALSE),0)"
        .Range(.Cells(zinus, c), .Cells(zinus, c)).Copy
        .Range(.Cells(zinus, c), .Cells(zinus, c)).PasteSpecial (xlPasteValues)
        Application.CutCopyMode = False
        
        If .Range(.Cells(zinus, c), .Cells(zinus, c)).Value = 0 Then .Range(.Cells(zinus, c), .Cells(zinus, c)).Value = ""
       zinus = zinus + 52
       nofi = nofi + 1
      Loop
      zinus = 51
      nofi = 1
      c = c + 1
      cw = cw + 1
    Loop
    
     'Macys Forecast
    c = cmatch
    'bycol = c + 20
    nofi = 1
    cw = 2
     Do While (c < bycol + 1)
      Do While (nofi < ((LastRow - 5) / 52) + 1)
        .Range(.Cells(macys, c), .Cells(macys, c)).Formula = "=IFERROR(VLOOKUP(G" & macys & ",[FcstNum.xlsx]Macys!$A$2:$AA$1200," & cw & ", FALSE),0)"
        .Range(.Cells(macys, c), .Cells(macys, c)).Copy
        .Range(.Cells(macys, c), .Cells(macys, c)).PasteSpecial (xlPasteValues)
        Application.CutCopyMode = False
        
        If .Range(.Cells(macys, c), .Cells(macys, c)).Value = 0 Then .Range(.Cells(macys, c), .Cells(macys, c)).Value = ""
       macys = macys + 52
       nofi = nofi + 1
      Loop
      macys = 52
      nofi = 1
      c = c + 1
      cw = cw + 1
    Loop
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
  End With


End Sub


Sub Updating_All_Channel_Prices() 'need to run ALL first then others, and wmt.

Dim r, c, bycol, nofi As Integer    'r indicates row, c indicates column
Dim LastRow, LastColumn As Long
Dim loc As Worksheet
Dim cname, cname2 As String

    Set loc = ThisWorkbook.Sheets("SB")  'loc=location

With loc
  LastRow = .Cells(.Rows.Count, "G").End(xlUp).Row
  LastColumn = .Range("F1").CurrentRegion.Columns.Count
  
    Application.Calculation = xlCalculationManual   'speed up
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False

    r = 34      'From AMAZON
    c = 11      'Starting Column (Edit this every week)
    bycol = 11  'Ending Column (Edit this every week)
    nofi = 1    'Number of Item
    
    Do While (c < bycol + 1)                        '+1 to include bycol
        
        Do While (nofi < ((LastRow - 5) / 52) + 1)  'Subtract 5 to skip the first five rows which are a header of table. Then divide by rows(52) needed for a sub-table of one item.
            
            Do While (r < 52 * nofi + 6)
                
                  
            .Range(.Cells(r, c), .Cells(r, c)).FormulaArray = "=IFERROR(INDEX([Price.xlsx]all!$A$2:$J$2000, MATCH('FR'!G" & r & ",([Price.xlsx]all!$A$2:$A$2000),0),MATCH('FR'!L" & r & ",([Price.xlsx]all!$A$1:$J$1),0)),"""")"
            .Range(.Cells(r, c), .Cells(r, c)).Copy
            .Range(.Cells(r, c), .Cells(r, c)).PasteSpecial (xlPasteValues)
            Application.CutCopyMode = False
            
            If .Range(.Cells(r, c), .Cells(r, c)).Value = 0 Then .Range(.Cells(r, c), .Cells(r, c)).Value = ""
             
            r = r + 1
            Loop
            

        r = r + 26      'Out at 52, to next Amazon row which is 86
        nofi = nofi + 1 'To next item
        Loop
    
    r = 34      'Back to FIRST channel(Amazon)
    nofi = 1    'Reset as default to repeat the loop
    c = c + 1   'Start from next column
    Loop
    
 End With
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
 
End Sub


Sub wayfair_Update_FcstNum()

Dim csc, hd, os, sc, target, wf, wmt, zinus, macys, cmatch, c, bycol, nofi, cw As Integer
Dim LastRow, LastColumn As Long
Dim loc As Worksheet

Dim startDate, startWK As Date
Dim startWK_val As Long
Dim lookup_range As Range

    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.DisplayStatusBar = False
    
    Set loc = ThisWorkbook.Sheets("SB")
    
    startDate = Date
    startWK = startDate - Weekday(startDate, 2)
    startWK_val = DateValue(startWK)
    
  With loc
    LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
    LastColumn = .Range("A1").CurrentRegion.Columns.Count
    Set lookup_range = .Range("A4:DL4")   'Range setting need to be updated regularly
    
    
    wf = 49
 
    
    
    cmatch = Application.WorksheetFunction.Match(startWK_val, lookup_range, 0)
    
    c = cmatch
    bycol = cmatch + 25   'for all accounts
    nofi = 1
    cw = 2
    
  
  
    
    'Wayfair DDS Forecast
    c = cmatch
    nofi = 1
    cw = 2
     Do While (c < bycol + 1)
      Do While (nofi < ((LastRow - 5) / 52) + 1)
        .Range(.Cells(wf, c), .Cells(wf, c)).Formula = "=IFERROR(VLOOKUP(G" & wf & ",[FcstNum.xlsx]WFDDS!$A$2:$AA$1200," & cw & ", FALSE),0)"
        .Range(.Cells(wf, c), .Cells(wf, c)).Copy
        .Range(.Cells(wf, c), .Cells(wf, c)).PasteSpecial (xlPasteValues)
        Application.CutCopyMode = False
        
        If .Range(.Cells(wf, c), .Cells(wf, c)).Value = 0 Then .Range(.Cells(wf, c), .Cells(wf, c)).Value = ""
       wf = wf + 52
       nofi = nofi + 1
      Loop
      
      wf = 49
      nofi = 1
      c = c + 1
      cw = cw + 1
    Loop
    
    
    
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
  End With


End Sub

